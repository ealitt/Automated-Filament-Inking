{"version":3,"file":"a11y.cjs.development.js","sources":["../src/announceStore.tsx","../src/A11yConsts.tsx","../src/A11ySection.tsx","../src/Html.tsx","../src/A11y.tsx","../src/A11yUserPreferences.tsx","../src/A11yAnnouncer.tsx","../src/A11yDebuger.tsx"],"sourcesContent":["import create from 'zustand';\r\n\r\ntype State = {\r\n  message: string;\r\n  a11yScreenReader: (message: string) => void;\r\n};\r\n\r\nconst useAnnounceStore = create<State>(set => {\r\n  return {\r\n    message: '',\r\n    a11yScreenReader: message => {\r\n      set(() => {\r\n        return { message: message };\r\n      });\r\n    },\r\n  };\r\n});\r\n\r\nexport default useAnnounceStore;\r\n","let stylesHiddenButScreenreadable = {\r\n  opacity: 0,\r\n  borderRadius: '50%',\r\n  width: '50px',\r\n  height: '50px',\r\n  overflow: 'hidden',\r\n  transform: 'translateX(-50%) translateY(-50%)',\r\n  display: 'inline-block',\r\n  userSelect: 'none' as const,\r\n  WebkitUserSelect: 'none' as const,\r\n  WebkitTouchCallout: 'none' as const,\r\n  margin: 0,\r\n};\r\n\r\nexport { stylesHiddenButScreenreadable };\r\n","import React, {\r\n  useContext,\r\n  useEffect,\r\n  useRef,\r\n  MutableRefObject,\r\n  createRef,\r\n} from 'react';\r\nimport { useThree } from '@react-three/fiber';\r\nimport { stylesHiddenButScreenreadable } from './A11yConsts';\r\n\r\ninterface Props {\r\n  children: React.ReactNode;\r\n  label: string;\r\n  description: string;\r\n}\r\n\r\nconst A11ySectionContext = React.createContext<\r\n  MutableRefObject<HTMLElement | null>\r\n>(createRef());\r\n\r\nA11ySectionContext.displayName = 'A11ySectionContext';\r\n\r\nconst useA11ySectionContext = () => {\r\n  return useContext(A11ySectionContext);\r\n};\r\n\r\nexport { useA11ySectionContext };\r\n\r\nexport const A11ySection: React.FC<Props> = ({\r\n  children,\r\n  label,\r\n  description,\r\n}) => {\r\n  const ref = useRef<HTMLElement | null>(null);\r\n  const refpDesc = useRef<HTMLParagraphElement | null>(null);\r\n  const gl = useThree(state => state.gl);\r\n  const [el] = React.useState(() => document.createElement('section'));\r\n  const target = gl.domElement.parentNode;\r\n\r\n  useEffect(() => {\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    if (label) {\r\n      el.setAttribute('aria-label', label);\r\n    }\r\n    el.setAttribute('r3f-a11y', 'true');\r\n    el.setAttribute(\r\n      'style',\r\n      (styles => {\r\n        return Object.keys(styles).reduce(\r\n          (acc, key) =>\r\n            acc +\r\n            key\r\n              .split(/(?=[A-Z])/)\r\n              .join('-')\r\n              .toLowerCase() +\r\n            ':' +\r\n            (styles as any)[key] +\r\n            ';',\r\n          ''\r\n        );\r\n      })(stylesHiddenButScreenreadable)\r\n    );\r\n    if (description) {\r\n      if (refpDesc.current === null) {\r\n        const pDesc = document.createElement('p');\r\n        pDesc.innerHTML = description;\r\n        pDesc.style.cssText =\r\n          'border: 0!important;clip: rect(1px,1px,1px,1px)!important;-webkit-clip-path: inset(50%)!important;clip-path: inset(50%)!important;height: 1px!important;margin: -1px!important;overflow: hidden!important;padding: 0!important;position: absolute!important;width: 1px!important;white-space: nowrap!important;';\r\n        el.prepend(pDesc);\r\n        refpDesc.current = pDesc;\r\n      } else {\r\n        refpDesc.current.innerHTML = description;\r\n      }\r\n    }\r\n    return () => {\r\n      if (target) target.removeChild(el);\r\n    };\r\n  }, [description, label]);\r\n\r\n  if (ref.current === null) {\r\n    if (target) {\r\n      target.appendChild(el);\r\n    }\r\n    ref.current = el;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <A11ySectionContext.Provider value={ref}>\r\n        {children}\r\n      </A11ySectionContext.Provider>\r\n    </>\r\n  );\r\n};\r\n","//https://raw.githubusercontent.com/pmndrs/drei/master/src/web/Html.tsx\r\nimport * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport {\r\n  Vector3,\r\n  Group,\r\n  Object3D,\r\n  Camera,\r\n  PerspectiveCamera,\r\n  OrthographicCamera,\r\n} from 'three';\r\nimport { Assign } from 'utility-types';\r\nimport { ReactThreeFiber, useFrame, useThree } from '@react-three/fiber';\r\n\r\nconst v1 = new Vector3();\r\nconst v2 = new Vector3();\r\nconst v3 = new Vector3();\r\n\r\nfunction calculatePosition(\r\n  el: Object3D,\r\n  camera: Camera,\r\n  size: { width: number; height: number }\r\n) {\r\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n  objectPos.project(camera);\r\n  const widthHalf = size.width / 2;\r\n  const heightHalf = size.height / 2;\r\n  return [\r\n    objectPos.x * widthHalf + widthHalf,\r\n    -(objectPos.y * heightHalf) + heightHalf,\r\n  ];\r\n}\r\n\r\nfunction isObjectBehindCamera(el: Object3D, camera: Camera) {\r\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n  const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\r\n  const deltaCamObj = objectPos.sub(cameraPos);\r\n  const camDir = camera.getWorldDirection(v3);\r\n  return deltaCamObj.angleTo(camDir) > Math.PI / 2;\r\n}\r\n\r\nfunction objectZIndex(\r\n  el: Object3D,\r\n  camera: Camera,\r\n  zIndexRange: Array<number>\r\n) {\r\n  if (\r\n    camera instanceof PerspectiveCamera ||\r\n    camera instanceof OrthographicCamera\r\n  ) {\r\n    const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n    const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\r\n    const dist = objectPos.distanceTo(cameraPos);\r\n    const A = (zIndexRange[1] - zIndexRange[0]) / (camera.far - camera.near);\r\n    const B = zIndexRange[1] - A * camera.far;\r\n    return Math.round(A * dist + B);\r\n  }\r\n  return undefined;\r\n}\r\n\r\nexport interface HtmlProps\r\n  extends Omit<\r\n    Assign<\r\n      React.HTMLAttributes<HTMLDivElement>,\r\n      ReactThreeFiber.Object3DNode<Group, typeof Group>\r\n    >,\r\n    'ref'\r\n  > {\r\n  eps?: number;\r\n  portal?: React.MutableRefObject<HTMLElement>;\r\n  zIndexRange?: Array<number>;\r\n}\r\n\r\nexport const Html = React.forwardRef(\r\n  (\r\n    {\r\n      children,\r\n      eps = 0.001,\r\n      style,\r\n      className,\r\n      portal,\r\n      zIndexRange = [16777271, 0],\r\n      ...props\r\n    }: HtmlProps,\r\n    ref: React.Ref<HTMLDivElement>\r\n  ) => {\r\n    const gl = useThree(({ gl }) => gl);\r\n    const camera = useThree(({ camera }) => camera);\r\n    const scene = useThree(({ scene }) => scene);\r\n    const size = useThree(({ size }) => size);\r\n    const [el] = React.useState(() => document.createElement('div'));\r\n    const group = React.useRef<Group>(null);\r\n    const oldZoom = React.useRef(0);\r\n    const oldPosition = React.useRef([0, 0]);\r\n    const target = portal?.current ?? gl.domElement.parentNode;\r\n\r\n    React.useEffect(() => {\r\n      if (group.current) {\r\n        scene.updateMatrixWorld();\r\n        const vec = calculatePosition(group.current, camera, size);\r\n        el.style.cssText = `position:absolute;top:0;left:0;transform:translate3d(${vec[0]}px,${vec[1]}px,0);transform-origin:0 0;`;\r\n        if (target) {\r\n          target.appendChild(el);\r\n        }\r\n        return () => {\r\n          if (target) target.removeChild(el);\r\n          ReactDOM.unmountComponentAtNode(el);\r\n        };\r\n      }\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [target]);\r\n\r\n    const styles: React.CSSProperties = React.useMemo(() => {\r\n      return {\r\n        position: 'absolute',\r\n        transform: 'none',\r\n        ...style,\r\n      };\r\n    }, [style, size]);\r\n\r\n    React.useLayoutEffect(() => {\r\n      ReactDOM.render(\r\n        <div\r\n          ref={ref}\r\n          style={styles}\r\n          className={className}\r\n          children={children}\r\n        />,\r\n        el\r\n      );\r\n    });\r\n\r\n    useFrame(() => {\r\n      if (group.current) {\r\n        camera.updateMatrixWorld();\r\n        const vec = calculatePosition(group.current, camera, size);\r\n\r\n        if (\r\n          Math.abs(oldZoom.current - camera.zoom) > eps ||\r\n          Math.abs(oldPosition.current[0] - vec[0]) > eps ||\r\n          Math.abs(oldPosition.current[1] - vec[1]) > eps\r\n        ) {\r\n          el.style.display = !isObjectBehindCamera(group.current, camera)\r\n            ? 'block'\r\n            : 'none';\r\n          el.style.zIndex = `${objectZIndex(\r\n            group.current,\r\n            camera,\r\n            zIndexRange\r\n          )}`;\r\n          el.style.transform = `translate3d(${vec[0]}px,${vec[1]}px,0) scale(1)`;\r\n          oldPosition.current = vec;\r\n          oldZoom.current = camera.zoom;\r\n        }\r\n      }\r\n    });\r\n\r\n    return <group {...props} ref={group} />;\r\n  }\r\n);\r\n","import React, { useEffect, useRef, useState, useContext } from 'react';\r\nimport { useThree } from '@react-three/fiber';\r\nimport useAnnounceStore from './announceStore';\r\nimport { useA11ySectionContext } from './A11ySection';\r\nimport { stylesHiddenButScreenreadable } from './A11yConsts';\r\nimport { Html } from './Html';\r\n\r\ninterface A11yCommonProps {\r\n  role: 'button' | 'togglebutton' | 'link' | 'content' | 'image';\r\n  children: React.ReactNode;\r\n  description: string;\r\n  tabIndex?: number;\r\n  showAltText?: boolean;\r\n  focusCall?: (...args: any[]) => any;\r\n  debug?: boolean;\r\n  a11yElStyle?: Object;\r\n  hidden?: boolean;\r\n}\r\n\r\ntype RoleProps =\r\n  | {\r\n      role: 'content';\r\n      activationMsg?: never;\r\n      deactivationMsg?: never;\r\n      actionCall?: never;\r\n      href?: never;\r\n      disabled?: never;\r\n      startPressed?: never;\r\n      tag?: 'p' | 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6';\r\n    }\r\n  | {\r\n      role: 'button';\r\n      activationMsg?: string;\r\n      deactivationMsg?: never;\r\n      actionCall?: () => any;\r\n      href?: never;\r\n      disabled?: boolean;\r\n      startPressed?: never;\r\n      tag?: never;\r\n    }\r\n  | {\r\n      role: 'togglebutton';\r\n      activationMsg?: string;\r\n      deactivationMsg?: string;\r\n      actionCall?: () => any;\r\n      href?: never;\r\n      disabled?: boolean;\r\n      startPressed?: boolean;\r\n      tag?: never;\r\n    }\r\n  | {\r\n      role: 'link';\r\n      activationMsg?: never;\r\n      deactivationMsg?: never;\r\n      actionCall: () => any;\r\n      href: string;\r\n      disabled?: never;\r\n      startPressed?: never;\r\n      tag?: never;\r\n    }\r\n  | {\r\n      role: 'image';\r\n      activationMsg?: never;\r\n      deactivationMsg?: never;\r\n      actionCall?: never;\r\n      href?: never;\r\n      disabled?: never;\r\n      startPressed?: never;\r\n      tag?: never;\r\n    };\r\n\r\ntype Props = A11yCommonProps & RoleProps;\r\n\r\nconst A11yContext = React.createContext({\r\n  focus: false,\r\n  hover: false,\r\n  pressed: false,\r\n});\r\n\r\nA11yContext.displayName = 'A11yContext';\r\n\r\nconst useA11y = () => {\r\n  return useContext(A11yContext);\r\n};\r\n\r\nexport { useA11y };\r\n\r\nexport const A11y: React.FC<Props> = ({\r\n  children,\r\n  description,\r\n  activationMsg,\r\n  deactivationMsg,\r\n  tabIndex,\r\n  href,\r\n  role,\r\n  showAltText = false,\r\n  actionCall,\r\n  focusCall,\r\n  disabled,\r\n  debug = false,\r\n  a11yElStyle,\r\n  startPressed = false,\r\n  tag = 'p',\r\n  hidden = false,\r\n  ...props\r\n}) => {\r\n  let constHiddenButScreenreadable = Object.assign(\r\n    {},\r\n    stylesHiddenButScreenreadable,\r\n    { opacity: debug ? 1 : 0 },\r\n    a11yElStyle\r\n  );\r\n\r\n  const [a11yState, setA11yState] = useState({\r\n    hovered: false,\r\n    focused: false,\r\n    pressed: startPressed ? startPressed : false,\r\n  });\r\n\r\n  const a11yScreenReader = useAnnounceStore(state => state.a11yScreenReader);\r\n\r\n  const overHtml = useRef(false);\r\n  const overMesh = useRef(false);\r\n\r\n  const domElement = useThree(state => state.gl.domElement);\r\n\r\n  // temporary fix to prevent error -> keep track of our component's mounted state\r\n  const componentIsMounted = useRef(true);\r\n  useEffect(() => {\r\n    return () => {\r\n      domElement.style.cursor = 'default';\r\n      componentIsMounted.current = false;\r\n    };\r\n  }, []); // Using an empty dependency array ensures this on\r\n\r\n  React.Children.only(children);\r\n  // @ts-ignore\r\n  const handleOnPointerOver = e => {\r\n    if (e.eventObject) {\r\n      overMesh.current = true;\r\n    } else {\r\n      overHtml.current = true;\r\n    }\r\n    if (overHtml.current || overMesh.current) {\r\n      if (role !== 'content' && role !== 'image' && !disabled) {\r\n        domElement.style.cursor = 'pointer';\r\n      }\r\n      setA11yState({\r\n        hovered: true,\r\n        focused: a11yState.focused,\r\n        pressed: a11yState.pressed,\r\n      });\r\n    }\r\n  };\r\n  // @ts-ignore\r\n  const handleOnPointerOut = e => {\r\n    if (e.eventObject) {\r\n      overMesh.current = false;\r\n    } else {\r\n      overHtml.current = false;\r\n    }\r\n    if (!overHtml.current && !overMesh.current) {\r\n      if (componentIsMounted.current) {\r\n        domElement.style.cursor = 'default';\r\n        setA11yState({\r\n          hovered: false,\r\n          focused: a11yState.focused,\r\n          pressed: a11yState.pressed,\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  function handleBtnClick() {\r\n    //msg is the same need to be clean for it to trigger again in case of multiple press in a row\r\n    a11yScreenReader('');\r\n    window.setTimeout(() => {\r\n      if (typeof activationMsg === 'string') a11yScreenReader(activationMsg);\r\n    }, 100);\r\n    if (typeof actionCall === 'function') actionCall();\r\n  }\r\n\r\n  function handleToggleBtnClick() {\r\n    if (a11yState.pressed) {\r\n      if (typeof deactivationMsg === 'string')\r\n        a11yScreenReader(deactivationMsg);\r\n    } else {\r\n      if (typeof activationMsg === 'string') a11yScreenReader(activationMsg);\r\n    }\r\n    setA11yState({\r\n      hovered: a11yState.hovered,\r\n      focused: a11yState.focused,\r\n      pressed: !a11yState.pressed,\r\n    });\r\n    if (typeof actionCall === 'function') actionCall();\r\n  }\r\n\r\n  const returnHtmlA11yEl = () => {\r\n    if (role === 'button' || role === 'togglebutton') {\r\n      let disabledBtnAttr = disabled\r\n        ? {\r\n            disabled: true,\r\n          }\r\n        : null;\r\n      if (role === 'togglebutton') {\r\n        return (\r\n          <button\r\n            r3f-a11y=\"true\"\r\n            {...disabledBtnAttr}\r\n            aria-pressed={a11yState.pressed ? 'true' : 'false'}\r\n            tabIndex={tabIndex ? tabIndex : 0}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              disabled ? { cursor: 'default' } : { cursor: 'pointer' },\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              if (disabled) {\r\n                return;\r\n              }\r\n              handleToggleBtnClick();\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          >\r\n            {description}\r\n          </button>\r\n        );\r\n      } else {\r\n        //regular btn\r\n        return (\r\n          <button\r\n            r3f-a11y=\"true\"\r\n            {...disabledBtnAttr}\r\n            tabIndex={tabIndex ? tabIndex : 0}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              disabled ? { cursor: 'default' } : { cursor: 'pointer' },\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              if (disabled) {\r\n                return;\r\n              }\r\n              handleBtnClick();\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          >\r\n            {description}\r\n          </button>\r\n        );\r\n      }\r\n    } else if (role === 'link') {\r\n      return (\r\n        <a\r\n          r3f-a11y=\"true\"\r\n          style={Object.assign(\r\n            constHiddenButScreenreadable,\r\n            hidden\r\n              ? { visibility: 'hidden' as const }\r\n              : { visibility: 'visible' as const }\r\n          )}\r\n          href={href}\r\n          onPointerOver={handleOnPointerOver}\r\n          onPointerOut={handleOnPointerOut}\r\n          onClick={e => {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            if (typeof actionCall === 'function') actionCall();\r\n          }}\r\n          onFocus={() => {\r\n            if (typeof focusCall === 'function') focusCall();\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: true,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n          onBlur={() => {\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: false,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n        >\r\n          {description}\r\n        </a>\r\n      );\r\n    } else {\r\n      let tabIndexP = tabIndex\r\n        ? {\r\n            tabIndex: tabIndex,\r\n          }\r\n        : null;\r\n      if (role === 'image') {\r\n        return (\r\n          <img\r\n            r3f-a11y=\"true\"\r\n            src=\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'/%3E\"\r\n            alt={description}\r\n            {...tabIndexP}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          />\r\n        );\r\n      } else {\r\n        const Tag = tag;\r\n        return (\r\n          <Tag\r\n            r3f-a11y=\"true\"\r\n            {...tabIndexP}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          >\r\n            {description}\r\n          </Tag>\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  const HtmlAccessibleElement = React.useMemo(returnHtmlA11yEl, [\r\n    description,\r\n    a11yState,\r\n    hidden,\r\n    tabIndex,\r\n    href,\r\n    disabled,\r\n    startPressed,\r\n    tag,\r\n    actionCall,\r\n    focusCall,\r\n  ]);\r\n\r\n  let AltText = null;\r\n  if (showAltText && a11yState.hovered) {\r\n    AltText = (\r\n      <div\r\n        aria-hidden={true}\r\n        style={{\r\n          width: 'auto',\r\n          maxWidth: '300px',\r\n          display: 'block',\r\n          position: 'absolute',\r\n          top: '0px',\r\n          left: '0px',\r\n          transform: 'translate(-50%,-50%)',\r\n          background: 'white',\r\n          borderRadius: '4px',\r\n          padding: '4px',\r\n        }}\r\n      >\r\n        <p\r\n          aria-hidden={true}\r\n          style={{\r\n            margin: '0px',\r\n          }}\r\n        >\r\n          {description}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const section = useA11ySectionContext();\r\n  let portal = {};\r\n  if (section.current instanceof HTMLElement) {\r\n    portal = { portal: section };\r\n  }\r\n\r\n  return (\r\n    <A11yContext.Provider\r\n      value={{\r\n        hover: a11yState.hovered,\r\n        focus: a11yState.focused,\r\n        pressed: a11yState.pressed,\r\n      }}\r\n    >\r\n      <group\r\n        {...props}\r\n        onClick={e => {\r\n          e.stopPropagation();\r\n          if (disabled) {\r\n            return;\r\n          }\r\n          if (role === 'button') {\r\n            handleBtnClick();\r\n          } else if (role === 'togglebutton') {\r\n            handleToggleBtnClick();\r\n          } else {\r\n            if (typeof actionCall === 'function') actionCall();\r\n          }\r\n        }}\r\n        onPointerOver={handleOnPointerOver}\r\n        onPointerOut={handleOnPointerOut}\r\n      >\r\n        {children}\r\n        <Html\r\n          style={{ width: '0px' }}\r\n          position={\r\n            // @ts-ignore\r\n            children.props.position ? children.props.position : 0\r\n          }\r\n          {...portal}\r\n        >\r\n          {AltText}\r\n          {HtmlAccessibleElement}\r\n        </Html>\r\n      </group>\r\n    </A11yContext.Provider>\r\n  );\r\n};\r\n","import React, { useEffect, useState, useContext } from 'react';\r\ninterface Props {\r\n  children: React.ReactNode;\r\n}\r\n\r\ntype aasetA11yPrefersState = {\r\n  prefersReducedMotion: boolean;\r\n  prefersDarkScheme: boolean;\r\n};\r\n\r\nconst A11yUserPreferencesContext = React.createContext({\r\n  a11yPrefersState: {\r\n    prefersReducedMotion: false,\r\n    prefersDarkScheme: false,\r\n  },\r\n  // tslint:disable:no-unused-variable\r\n  setA11yPrefersState: (_state: aasetA11yPrefersState) => {},\r\n  // tslint:enable:no-unused-variable\r\n});\r\n\r\nA11yUserPreferencesContext.displayName = 'A11yUserPreferencesContext';\r\n\r\nconst useUserPreferences = () => {\r\n  return useContext(A11yUserPreferencesContext);\r\n};\r\n\r\nexport { useUserPreferences, A11yUserPreferencesContext };\r\n\r\nexport const A11yUserPreferences: React.FC<Props> = ({ children }) => {\r\n  const [a11yPrefersState, setA11yPrefersState] = useState({\r\n    prefersReducedMotion: false,\r\n    prefersDarkScheme: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const prefersReducedMotionMediaQuery = window.matchMedia(\r\n      '(prefers-reduced-motion: reduce)'\r\n    );\r\n    const prefersDarkSchemeMediaQuery = window.matchMedia(\r\n      '(prefers-color-scheme: dark)'\r\n    );\r\n\r\n    setA11yPrefersState({\r\n      prefersReducedMotion: prefersReducedMotionMediaQuery.matches,\r\n      prefersDarkScheme: prefersDarkSchemeMediaQuery.matches,\r\n    });\r\n\r\n    const handleReducedMotionPrefChange = (e: MediaQueryListEvent) => {\r\n      setA11yPrefersState({\r\n        prefersReducedMotion: e.matches,\r\n        prefersDarkScheme: prefersDarkSchemeMediaQuery.matches,\r\n      });\r\n    };\r\n    const handleDarkSchemePrefChange = (e: MediaQueryListEvent) => {\r\n      setA11yPrefersState({\r\n        prefersReducedMotion: prefersReducedMotionMediaQuery.matches,\r\n        prefersDarkScheme: e.matches,\r\n      });\r\n    };\r\n\r\n    if (typeof prefersReducedMotionMediaQuery.addEventListener === 'function') {\r\n      prefersReducedMotionMediaQuery.addEventListener(\r\n        'change',\r\n        handleReducedMotionPrefChange\r\n      );\r\n    }\r\n    if (typeof prefersDarkSchemeMediaQuery.addEventListener === 'function') {\r\n      prefersDarkSchemeMediaQuery.addEventListener(\r\n        'change',\r\n        handleDarkSchemePrefChange\r\n      );\r\n    }\r\n    return () => {\r\n      if (\r\n        typeof prefersReducedMotionMediaQuery.removeEventListener === 'function'\r\n      ) {\r\n        prefersReducedMotionMediaQuery.removeEventListener(\r\n          'change',\r\n          handleReducedMotionPrefChange\r\n        );\r\n      }\r\n      if (\r\n        typeof prefersDarkSchemeMediaQuery.removeEventListener === 'function'\r\n      ) {\r\n        prefersDarkSchemeMediaQuery.removeEventListener(\r\n          'change',\r\n          handleDarkSchemePrefChange\r\n        );\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <A11yUserPreferencesContext.Provider\r\n      value={{\r\n        a11yPrefersState: {\r\n          prefersReducedMotion: a11yPrefersState.prefersReducedMotion,\r\n          prefersDarkScheme: a11yPrefersState.prefersDarkScheme,\r\n        },\r\n        setA11yPrefersState: setA11yPrefersState,\r\n      }}\r\n    >\r\n      {children}\r\n    </A11yUserPreferencesContext.Provider>\r\n  );\r\n};\r\n","import React, { useEffect } from 'react';\r\nimport useAnnounceStore from './announceStore';\r\n\r\nconst offScreenStyle = {\r\n  border: 0,\r\n  clip: 'rect(0 0 0 0)',\r\n  height: '1px',\r\n  margin: '-1px',\r\n  overflow: 'hidden',\r\n  whiteSpace: 'nowrap' as const,\r\n  padding: 0,\r\n  width: '1px',\r\n  position: 'absolute' as const,\r\n};\r\n\r\nexport const A11yAnnouncer: React.FC = () => {\r\n  const message = useAnnounceStore(state => state.message);\r\n\r\n  useEffect(() => {\r\n    const mouseClickListener = (e: MouseEvent) => {\r\n      if (\r\n        window.document.activeElement?.getAttribute('r3f-a11y') &&\r\n        e.detail !== 0\r\n      ) {\r\n        if (window.document.activeElement instanceof HTMLElement) {\r\n          window.document.activeElement.blur();\r\n        }\r\n      }\r\n    };\r\n    window.addEventListener('click', mouseClickListener);\r\n    return () => {\r\n      window.removeEventListener('click', mouseClickListener);\r\n    };\r\n  });\r\n\r\n  return (\r\n    <div style={offScreenStyle} aria-atomic=\"true\" aria-live=\"polite\">\r\n      {message}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useLayoutEffect, useEffect, useState, useRef } from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport { useUserPreferences } from './A11yUserPreferences';\r\ninterface Props {}\r\n\r\nexport const A11yDebuger: React.FC<Props> = ({}) => {\r\n  const [el] = useState(() => document.createElement('div'));\r\n  const [boundingStyle, setBoundingStyle] = useState({});\r\n  const [debugState, setDebugState] = useState({\r\n    prefersDarkScheme: false,\r\n    prefersReducedMotion: false,\r\n  });\r\n  const { a11yPrefersState, setA11yPrefersState } = useUserPreferences();\r\n  const domStructureRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    el.style.cssText = 'position:fixed;top:0;left:0;';\r\n    el.setAttribute('aria-hidden', 'true');\r\n    document.body.appendChild(el);\r\n    setDebugState({\r\n      prefersDarkScheme: a11yPrefersState.prefersDarkScheme,\r\n      prefersReducedMotion: a11yPrefersState.prefersReducedMotion,\r\n    });\r\n    const selectActiveEl = () => {\r\n      console.log('focused: ', document.activeElement);\r\n      let r3fa11ydebugidref = document.activeElement?.getAttribute(\r\n        'r3f-a11y-debug-id'\r\n      );\r\n      if (r3fa11ydebugidref) {\r\n        document.querySelectorAll('[r3fa11ydebugidref]').forEach(node => {\r\n          //@ts-ignore\r\n          node.style.color = null;\r\n        });\r\n        let refEl = document.querySelector(\r\n          '[r3fa11ydebugidref=\"' + r3fa11ydebugidref + '\"]'\r\n        );\r\n        if (refEl) {\r\n          //@ts-ignore\r\n          refEl.style.color = 'red';\r\n        }\r\n      }\r\n    };\r\n    console.log('enregistre ev');\r\n    document.addEventListener('focus', selectActiveEl, true);\r\n    let superinterval = window.setInterval(() => {\r\n      let r3fPosId = 0;\r\n      //@ts-ignore\r\n      let elements = [];\r\n      document.querySelectorAll('[r3f-a11y]').forEach(node => {\r\n        node.setAttribute('r3f-a11y-debug-id', '' + r3fPosId);\r\n        // let li = document.createElement('li');\r\n        // li.innerHTML = node.tagName ;\r\n        // //@ts-ignore\r\n        // domStructureRef.current.appendChild(li);\r\n        elements.push(\r\n          //@ts-ignore\r\n          <li key={r3fPosId} r3fa11ydebugidref={r3fPosId}>\r\n            {node.tagName}\r\n            <button\r\n              tabIndex={-1}\r\n              onClick={() => {\r\n                console.log(node);\r\n                let clientRect = node.getBoundingClientRect();\r\n                setBoundingStyle({\r\n                  width: clientRect.width,\r\n                  height: clientRect.height,\r\n                  top: clientRect.top,\r\n                  left: clientRect.left,\r\n                });\r\n              }}\r\n            >\r\n              Show\r\n            </button>\r\n          </li>\r\n        );\r\n        r3fPosId++;\r\n      });\r\n      //@ts-ignore\r\n      ReactDOM.render(<>{elements}</>, domStructureRef.current);\r\n    }, 2000);\r\n    return () => {\r\n      clearInterval(superinterval);\r\n      ReactDOM.unmountComponentAtNode(el);\r\n      console.log('remove ev');\r\n      document.removeEventListener('focus', selectActiveEl, true);\r\n    };\r\n  }, [a11yPrefersState]);\r\n\r\n  // @ts-ignore\r\n  const handleChange = e => {\r\n    // @ts-ignore\r\n    setA11yPrefersState({\r\n      prefersDarkScheme:\r\n        e.target.name === 'prefersDarkScheme'\r\n          ? e.target.checked\r\n          : debugState.prefersDarkScheme,\r\n      prefersReducedMotion:\r\n        e.target.name === 'prefersReducedMotion'\r\n          ? e.target.checked\r\n          : debugState.prefersReducedMotion,\r\n    });\r\n  };\r\n\r\n  useLayoutEffect(() => {\r\n    return void ReactDOM.render(\r\n      <>\r\n        <label>\r\n          Prefer dark mode\r\n          <input\r\n            type=\"checkbox\"\r\n            name=\"prefersDarkScheme\"\r\n            checked={debugState.prefersDarkScheme}\r\n            onChange={handleChange}\r\n          />\r\n        </label>\r\n        <label>\r\n          Prefer reduced motion\r\n          <input\r\n            type=\"checkbox\"\r\n            name=\"prefersReducedMotion\"\r\n            checked={debugState.prefersReducedMotion}\r\n            onChange={handleChange}\r\n          />\r\n        </label>\r\n        <h3>R3F Dom order</h3>\r\n        <ul ref={domStructureRef}></ul>\r\n        <div\r\n          style={Object.assign(\r\n            {\r\n              position: 'absolute' as const,\r\n              border: '1px solid white',\r\n              borderRadius: '50%',\r\n              background:\r\n                'linear-gradient( 45deg, rgb(70, 255, 60, 0.7), rgb(0, 64, 193, 0.7))',\r\n              pointerEvents: 'none' as const,\r\n              transition: 'all 200ms ease',\r\n            },\r\n            boundingStyle\r\n          )}\r\n        ></div>\r\n      </>,\r\n      el\r\n    );\r\n  });\r\n\r\n  return <></>;\r\n};\r\n"],"names":["useAnnounceStore","create","set","message","a11yScreenReader","stylesHiddenButScreenreadable","opacity","borderRadius","width","height","overflow","transform","display","userSelect","WebkitUserSelect","WebkitTouchCallout","margin","A11ySectionContext","React","createContext","createRef","displayName","useA11ySectionContext","useContext","A11ySection","children","label","description","ref","useRef","refpDesc","gl","useThree","state","useState","document","createElement","el","target","domElement","parentNode","useEffect","setAttribute","styles","Object","keys","reduce","acc","key","split","join","toLowerCase","current","pDesc","innerHTML","style","cssText","prepend","removeChild","appendChild","Provider","value","v1","Vector3","v2","v3","calculatePosition","camera","size","objectPos","setFromMatrixPosition","matrixWorld","project","widthHalf","heightHalf","x","y","isObjectBehindCamera","cameraPos","deltaCamObj","sub","camDir","getWorldDirection","angleTo","Math","PI","objectZIndex","zIndexRange","PerspectiveCamera","OrthographicCamera","dist","distanceTo","A","far","near","B","round","undefined","Html","eps","className","portal","props","scene","group","oldZoom","oldPosition","updateMatrixWorld","vec","ReactDOM","position","useFrame","abs","zoom","zIndex","A11yContext","focus","hover","pressed","useA11y","A11y","activationMsg","deactivationMsg","tabIndex","href","role","showAltText","actionCall","focusCall","disabled","debug","a11yElStyle","startPressed","tag","hidden","constHiddenButScreenreadable","assign","hovered","focused","a11yState","setA11yState","overHtml","overMesh","componentIsMounted","cursor","Children","only","handleOnPointerOver","e","eventObject","handleOnPointerOut","handleBtnClick","window","setTimeout","handleToggleBtnClick","returnHtmlA11yEl","disabledBtnAttr","visibility","onPointerOver","onPointerOut","onClick","stopPropagation","onFocus","onBlur","preventDefault","tabIndexP","src","alt","Tag","HtmlAccessibleElement","useMemo","AltText","maxWidth","top","left","background","padding","section","HTMLElement","A11yUserPreferencesContext","a11yPrefersState","prefersReducedMotion","prefersDarkScheme","setA11yPrefersState","_state","useUserPreferences","A11yUserPreferences","prefersReducedMotionMediaQuery","matchMedia","prefersDarkSchemeMediaQuery","matches","handleReducedMotionPrefChange","handleDarkSchemePrefChange","addEventListener","removeEventListener","offScreenStyle","border","clip","whiteSpace","A11yAnnouncer","mouseClickListener","activeElement","getAttribute","detail","blur","A11yDebuger","boundingStyle","setBoundingStyle","debugState","setDebugState","domStructureRef","body","selectActiveEl","console","log","r3fa11ydebugidref","querySelectorAll","forEach","node","color","refEl","querySelector","superinterval","setInterval","r3fPosId","elements","push","tagName","clientRect","getBoundingClientRect","clearInterval","handleChange","name","checked","useLayoutEffect","type","onChange","pointerEvents","transition"],"mappings":"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"}