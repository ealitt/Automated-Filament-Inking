"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),r=e(t),n=require("@react-three/fiber"),o=e(require("zustand")),i=require("react-dom"),s=require("three");function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)t.indexOf(r=i[n])>=0||(o[r]=e[r]);return o}var u=o((function(e){return{message:"",a11yScreenReader:function(t){e((function(){return{message:t}}))}}})),d={opacity:0,borderRadius:"50%",width:"50px",height:"50px",overflow:"hidden",transform:"translateX(-50%) translateY(-50%)",display:"inline-block",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none",margin:0},l=r.createContext(t.createRef());l.displayName="A11ySectionContext";var f=new s.Vector3,p=new s.Vector3,m=new s.Vector3;function v(e,t,r){var n=f.setFromMatrixPosition(e.matrixWorld);n.project(t);var o=r.width/2,i=r.height/2;return[n.x*o+o,-n.y*i+i]}var h=t.forwardRef((function(e,r){var o,u=e.children,d=e.eps,l=void 0===d?.001:d,h=e.style,y=e.className,g=e.portal,b=e.zIndexRange,x=void 0===b?[16777271,0]:b,E=c(e,["children","eps","style","className","portal","zIndexRange"]),w=n.useThree((function(e){return e.gl})),k=n.useThree((function(e){return e.camera})),P=n.useThree((function(e){return e.scene})),S=n.useThree((function(e){return e.size})),M=t.useState((function(){return document.createElement("div")}))[0],C=t.useRef(null),O=t.useRef(0),R=t.useRef([0,0]),A=null!=(o=null==g?void 0:g.current)?o:w.domElement.parentNode;t.useEffect((function(){if(C.current){P.updateMatrixWorld();var e=v(C.current,k,S);return M.style.cssText="position:absolute;top:0;left:0;transform:translate3d("+e[0]+"px,"+e[1]+"px,0);transform-origin:0 0;",A&&A.appendChild(M),function(){A&&A.removeChild(M),i.unmountComponentAtNode(M)}}}),[A]);var j=t.useMemo((function(){return a({position:"absolute",transform:"none"},h)}),[h,S]);return t.useLayoutEffect((function(){i.render(t.createElement("div",{ref:r,style:j,className:y,children:u}),M)})),n.useFrame((function(){if(C.current){k.updateMatrixWorld();var e=v(C.current,k,S);(Math.abs(O.current-k.zoom)>l||Math.abs(R.current[0]-e[0])>l||Math.abs(R.current[1]-e[1])>l)&&(M.style.display=function(e,t){var r=f.setFromMatrixPosition(e.matrixWorld),n=p.setFromMatrixPosition(t.matrixWorld),o=r.sub(n),i=t.getWorldDirection(m);return o.angleTo(i)>Math.PI/2}(C.current,k)?"none":"block",M.style.zIndex=""+function(e,t,r){if(t instanceof s.PerspectiveCamera||t instanceof s.OrthographicCamera){var n=f.setFromMatrixPosition(e.matrixWorld),o=p.setFromMatrixPosition(t.matrixWorld),i=n.distanceTo(o),a=(r[1]-r[0])/(t.far-t.near);return Math.round(a*i+(r[1]-a*t.far))}}(C.current,k,x),M.style.transform="translate3d("+e[0]+"px,"+e[1]+"px,0) scale(1)",R.current=e,O.current=k.zoom)}})),t.createElement("group",Object.assign({},E,{ref:C}))})),y=r.createContext({focus:!1,hover:!1,pressed:!1});y.displayName="A11yContext";var g=r.createContext({a11yPrefersState:{prefersReducedMotion:!1,prefersDarkScheme:!1},setA11yPrefersState:function(e){}});g.displayName="A11yUserPreferencesContext";var b=function(){return t.useContext(g)},x={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",whiteSpace:"nowrap",padding:0,width:"1px",position:"absolute"};exports.A11y=function(e){var o=e.children,i=e.description,s=e.activationMsg,a=e.deactivationMsg,f=e.tabIndex,p=e.href,m=e.role,v=e.showAltText,g=void 0!==v&&v,b=e.actionCall,x=e.focusCall,E=e.disabled,w=e.debug,k=void 0!==w&&w,P=e.a11yElStyle,S=e.startPressed,M=void 0!==S&&S,C=e.tag,O=void 0===C?"p":C,R=e.hidden,A=void 0!==R&&R,j=c(e,["children","description","activationMsg","deactivationMsg","tabIndex","href","role","showAltText","actionCall","focusCall","disabled","debug","a11yElStyle","startPressed","tag","hidden"]),T=Object.assign({},d,{opacity:k?1:0},P),D=t.useState({hovered:!1,focused:!1,pressed:M||!1}),L=D[0],F=D[1],I=u((function(e){return e.a11yScreenReader})),N=t.useRef(!1),W=t.useRef(!1),q=n.useThree((function(e){return e.gl.domElement})),z=t.useRef(!0);t.useEffect((function(){return function(){q.style.cursor="default",z.current=!1}}),[]),r.Children.only(o);var B=function(e){e.eventObject?W.current=!0:N.current=!0,(N.current||W.current)&&("content"===m||"image"===m||E||(q.style.cursor="pointer"),F({hovered:!0,focused:L.focused,pressed:L.pressed}))},U=function(e){e.eventObject?W.current=!1:N.current=!1,N.current||W.current||z.current&&(q.style.cursor="default",F({hovered:!1,focused:L.focused,pressed:L.pressed}))};function H(){I(""),window.setTimeout((function(){"string"==typeof s&&I(s)}),100),"function"==typeof b&&b()}function V(){L.pressed?"string"==typeof a&&I(a):"string"==typeof s&&I(s),F({hovered:L.hovered,focused:L.focused,pressed:!L.pressed}),"function"==typeof b&&b()}var _=r.useMemo((function(){if("button"===m||"togglebutton"===m)return r.createElement("button",Object.assign({"r3f-a11y":"true"},E?{disabled:!0}:null,"togglebutton"===m?{"aria-pressed":L.pressed?"true":"false",tabIndex:f||0,style:Object.assign(T,E?{cursor:"default"}:{cursor:"pointer"},A?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:B,onPointerOut:U,onClick:function(e){e.stopPropagation(),E||V()},onFocus:function(){"function"==typeof x&&x(),F({hovered:L.hovered,focused:!0,pressed:L.pressed})},onBlur:function(){F({hovered:L.hovered,focused:!1,pressed:L.pressed})}}:{tabIndex:f||0,style:Object.assign(T,E?{cursor:"default"}:{cursor:"pointer"},A?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:B,onPointerOut:U,onClick:function(e){e.stopPropagation(),E||H()},onFocus:function(){"function"==typeof x&&x(),F({hovered:L.hovered,focused:!0,pressed:L.pressed})},onBlur:function(){F({hovered:L.hovered,focused:!1,pressed:L.pressed})}}),i);if("link"===m)return r.createElement("a",{"r3f-a11y":"true",style:Object.assign(T,A?{visibility:"hidden"}:{visibility:"visible"}),href:p,onPointerOver:B,onPointerOut:U,onClick:function(e){e.stopPropagation(),e.preventDefault(),"function"==typeof b&&b()},onFocus:function(){"function"==typeof x&&x(),F({hovered:L.hovered,focused:!0,pressed:L.pressed})},onBlur:function(){F({hovered:L.hovered,focused:!1,pressed:L.pressed})}},i);var e=f?{tabIndex:f}:null;return"image"===m?r.createElement("img",Object.assign({"r3f-a11y":"true",src:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'/%3E",alt:i},e,{style:Object.assign(T,A?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:B,onPointerOut:U,onBlur:function(){F({hovered:L.hovered,focused:!1,pressed:L.pressed})},onFocus:function(){"function"==typeof x&&x(),F({hovered:L.hovered,focused:!0,pressed:L.pressed})}})):r.createElement(O,Object.assign({"r3f-a11y":"true"},e,{style:Object.assign(T,A?{visibility:"hidden"}:{visibility:"visible"}),onPointerOver:B,onPointerOut:U,onBlur:function(){F({hovered:L.hovered,focused:!1,pressed:L.pressed})},onFocus:function(){"function"==typeof x&&x(),F({hovered:L.hovered,focused:!0,pressed:L.pressed})}}),i)}),[i,L,A,f,p,E,M,O,b,x]),X=null;g&&L.hovered&&(X=r.createElement("div",{"aria-hidden":!0,style:{width:"auto",maxWidth:"300px",display:"block",position:"absolute",top:"0px",left:"0px",transform:"translate(-50%,-50%)",background:"white",borderRadius:"4px",padding:"4px"}},r.createElement("p",{"aria-hidden":!0,style:{margin:"0px"}},i)));var Y=t.useContext(l),Z={};return Y.current instanceof HTMLElement&&(Z={portal:Y}),r.createElement(y.Provider,{value:{hover:L.hovered,focus:L.focused,pressed:L.pressed}},r.createElement("group",Object.assign({},j,{onClick:function(e){e.stopPropagation(),E||("button"===m?H():"togglebutton"===m?V():"function"==typeof b&&b())},onPointerOver:B,onPointerOut:U}),o,r.createElement(h,Object.assign({style:{width:"0px"},position:o.props.position?o.props.position:0},Z),X,_)))},exports.A11yAnnouncer=function(){var e=u((function(e){return e.message}));return t.useEffect((function(){var e=function(e){var t;null!=(t=window.document.activeElement)&&t.getAttribute("r3f-a11y")&&0!==e.detail&&window.document.activeElement instanceof HTMLElement&&window.document.activeElement.blur()};return window.addEventListener("click",e),function(){window.removeEventListener("click",e)}})),r.createElement("div",{style:x,"aria-atomic":"true","aria-live":"polite"},e)},exports.A11yDebuger=function(e){!function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(e);var n=t.useState((function(){return document.createElement("div")}))[0],o=t.useState({}),s=o[0],a=o[1],c=t.useState({prefersDarkScheme:!1,prefersReducedMotion:!1}),u=c[0],d=c[1],l=b(),f=l.a11yPrefersState,p=l.setA11yPrefersState,m=t.useRef(null);t.useEffect((function(){n.style.cssText="position:fixed;top:0;left:0;",n.setAttribute("aria-hidden","true"),document.body.appendChild(n),d({prefersDarkScheme:f.prefersDarkScheme,prefersReducedMotion:f.prefersReducedMotion});var e=function(){var e;console.log("focused: ",document.activeElement);var t=null==(e=document.activeElement)?void 0:e.getAttribute("r3f-a11y-debug-id");if(t){document.querySelectorAll("[r3fa11ydebugidref]").forEach((function(e){e.style.color=null}));var r=document.querySelector('[r3fa11ydebugidref="'+t+'"]');r&&(r.style.color="red")}};console.log("enregistre ev"),document.addEventListener("focus",e,!0);var t=window.setInterval((function(){var e=0,t=[];document.querySelectorAll("[r3f-a11y]").forEach((function(n){n.setAttribute("r3f-a11y-debug-id",""+e),t.push(r.createElement("li",{key:e,r3fa11ydebugidref:e},n.tagName,r.createElement("button",{tabIndex:-1,onClick:function(){console.log(n);var e=n.getBoundingClientRect();a({width:e.width,height:e.height,top:e.top,left:e.left})}},"Show"))),e++})),i.render(r.createElement(r.Fragment,null,t),m.current)}),2e3);return function(){clearInterval(t),i.unmountComponentAtNode(n),console.log("remove ev"),document.removeEventListener("focus",e,!0)}}),[f]);var v=function(e){p({prefersDarkScheme:"prefersDarkScheme"===e.target.name?e.target.checked:u.prefersDarkScheme,prefersReducedMotion:"prefersReducedMotion"===e.target.name?e.target.checked:u.prefersReducedMotion})};return t.useLayoutEffect((function(){i.render(r.createElement(r.Fragment,null,r.createElement("label",null,"Prefer dark mode",r.createElement("input",{type:"checkbox",name:"prefersDarkScheme",checked:u.prefersDarkScheme,onChange:v})),r.createElement("label",null,"Prefer reduced motion",r.createElement("input",{type:"checkbox",name:"prefersReducedMotion",checked:u.prefersReducedMotion,onChange:v})),r.createElement("h3",null,"R3F Dom order"),r.createElement("ul",{ref:m}),r.createElement("div",{style:Object.assign({position:"absolute",border:"1px solid white",borderRadius:"50%",background:"linear-gradient( 45deg, rgb(70, 255, 60, 0.7), rgb(0, 64, 193, 0.7))",pointerEvents:"none",transition:"all 200ms ease"},s)})),n)})),r.createElement(r.Fragment,null)},exports.A11ySection=function(e){var o=e.children,i=e.label,s=e.description,a=t.useRef(null),c=t.useRef(null),u=n.useThree((function(e){return e.gl})),f=r.useState((function(){return document.createElement("section")}))[0],p=u.domElement.parentNode;return t.useEffect((function(){var e;if(i&&f.setAttribute("aria-label",i),f.setAttribute("r3f-a11y","true"),f.setAttribute("style",(e=d,Object.keys(e).reduce((function(t,r){return t+r.split(/(?=[A-Z])/).join("-").toLowerCase()+":"+e[r]+";"}),""))),s)if(null===c.current){var t=document.createElement("p");t.innerHTML=s,t.style.cssText="border: 0!important;clip: rect(1px,1px,1px,1px)!important;-webkit-clip-path: inset(50%)!important;clip-path: inset(50%)!important;height: 1px!important;margin: -1px!important;overflow: hidden!important;padding: 0!important;position: absolute!important;width: 1px!important;white-space: nowrap!important;",f.prepend(t),c.current=t}else c.current.innerHTML=s;return function(){p&&p.removeChild(f)}}),[s,i]),null===a.current&&(p&&p.appendChild(f),a.current=f),r.createElement(r.Fragment,null,r.createElement(l.Provider,{value:a},o))},exports.A11yUserPreferences=function(e){var n=e.children,o=t.useState({prefersReducedMotion:!1,prefersDarkScheme:!1}),i=o[0],s=o[1];return t.useEffect((function(){var e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=window.matchMedia("(prefers-color-scheme: dark)");s({prefersReducedMotion:e.matches,prefersDarkScheme:t.matches});var r=function(e){s({prefersReducedMotion:e.matches,prefersDarkScheme:t.matches})},n=function(t){s({prefersReducedMotion:e.matches,prefersDarkScheme:t.matches})};return"function"==typeof e.addEventListener&&e.addEventListener("change",r),"function"==typeof t.addEventListener&&t.addEventListener("change",n),function(){"function"==typeof e.removeEventListener&&e.removeEventListener("change",r),"function"==typeof t.removeEventListener&&t.removeEventListener("change",n)}}),[]),r.createElement(g.Provider,{value:{a11yPrefersState:{prefersReducedMotion:i.prefersReducedMotion,prefersDarkScheme:i.prefersDarkScheme},setA11yPrefersState:s}},n)},exports.A11yUserPreferencesContext=g,exports.useA11y=function(){return t.useContext(y)},exports.useUserPreferences=b;
//# sourceMappingURL=a11y.cjs.production.min.js.map
