{"version":3,"file":"a11y.cjs.production.min.js","sources":["../src/announceStore.tsx","../src/A11yConsts.tsx","../src/A11ySection.tsx","../src/Html.tsx","../src/A11y.tsx","../src/A11yUserPreferences.tsx","../src/A11yAnnouncer.tsx","../src/A11yDebuger.tsx"],"sourcesContent":["import create from 'zustand';\r\n\r\ntype State = {\r\n  message: string;\r\n  a11yScreenReader: (message: string) => void;\r\n};\r\n\r\nconst useAnnounceStore = create<State>(set => {\r\n  return {\r\n    message: '',\r\n    a11yScreenReader: message => {\r\n      set(() => {\r\n        return { message: message };\r\n      });\r\n    },\r\n  };\r\n});\r\n\r\nexport default useAnnounceStore;\r\n","let stylesHiddenButScreenreadable = {\r\n  opacity: 0,\r\n  borderRadius: '50%',\r\n  width: '50px',\r\n  height: '50px',\r\n  overflow: 'hidden',\r\n  transform: 'translateX(-50%) translateY(-50%)',\r\n  display: 'inline-block',\r\n  userSelect: 'none' as const,\r\n  WebkitUserSelect: 'none' as const,\r\n  WebkitTouchCallout: 'none' as const,\r\n  margin: 0,\r\n};\r\n\r\nexport { stylesHiddenButScreenreadable };\r\n","import React, {\r\n  useContext,\r\n  useEffect,\r\n  useRef,\r\n  MutableRefObject,\r\n  createRef,\r\n} from 'react';\r\nimport { useThree } from '@react-three/fiber';\r\nimport { stylesHiddenButScreenreadable } from './A11yConsts';\r\n\r\ninterface Props {\r\n  children: React.ReactNode;\r\n  label: string;\r\n  description: string;\r\n}\r\n\r\nconst A11ySectionContext = React.createContext<\r\n  MutableRefObject<HTMLElement | null>\r\n>(createRef());\r\n\r\nA11ySectionContext.displayName = 'A11ySectionContext';\r\n\r\nconst useA11ySectionContext = () => {\r\n  return useContext(A11ySectionContext);\r\n};\r\n\r\nexport { useA11ySectionContext };\r\n\r\nexport const A11ySection: React.FC<Props> = ({\r\n  children,\r\n  label,\r\n  description,\r\n}) => {\r\n  const ref = useRef<HTMLElement | null>(null);\r\n  const refpDesc = useRef<HTMLParagraphElement | null>(null);\r\n  const gl = useThree(state => state.gl);\r\n  const [el] = React.useState(() => document.createElement('section'));\r\n  const target = gl.domElement.parentNode;\r\n\r\n  useEffect(() => {\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    if (label) {\r\n      el.setAttribute('aria-label', label);\r\n    }\r\n    el.setAttribute('r3f-a11y', 'true');\r\n    el.setAttribute(\r\n      'style',\r\n      (styles => {\r\n        return Object.keys(styles).reduce(\r\n          (acc, key) =>\r\n            acc +\r\n            key\r\n              .split(/(?=[A-Z])/)\r\n              .join('-')\r\n              .toLowerCase() +\r\n            ':' +\r\n            (styles as any)[key] +\r\n            ';',\r\n          ''\r\n        );\r\n      })(stylesHiddenButScreenreadable)\r\n    );\r\n    if (description) {\r\n      if (refpDesc.current === null) {\r\n        const pDesc = document.createElement('p');\r\n        pDesc.innerHTML = description;\r\n        pDesc.style.cssText =\r\n          'border: 0!important;clip: rect(1px,1px,1px,1px)!important;-webkit-clip-path: inset(50%)!important;clip-path: inset(50%)!important;height: 1px!important;margin: -1px!important;overflow: hidden!important;padding: 0!important;position: absolute!important;width: 1px!important;white-space: nowrap!important;';\r\n        el.prepend(pDesc);\r\n        refpDesc.current = pDesc;\r\n      } else {\r\n        refpDesc.current.innerHTML = description;\r\n      }\r\n    }\r\n    return () => {\r\n      if (target) target.removeChild(el);\r\n    };\r\n  }, [description, label]);\r\n\r\n  if (ref.current === null) {\r\n    if (target) {\r\n      target.appendChild(el);\r\n    }\r\n    ref.current = el;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <A11ySectionContext.Provider value={ref}>\r\n        {children}\r\n      </A11ySectionContext.Provider>\r\n    </>\r\n  );\r\n};\r\n","//https://raw.githubusercontent.com/pmndrs/drei/master/src/web/Html.tsx\r\nimport * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport {\r\n  Vector3,\r\n  Group,\r\n  Object3D,\r\n  Camera,\r\n  PerspectiveCamera,\r\n  OrthographicCamera,\r\n} from 'three';\r\nimport { Assign } from 'utility-types';\r\nimport { ReactThreeFiber, useFrame, useThree } from '@react-three/fiber';\r\n\r\nconst v1 = new Vector3();\r\nconst v2 = new Vector3();\r\nconst v3 = new Vector3();\r\n\r\nfunction calculatePosition(\r\n  el: Object3D,\r\n  camera: Camera,\r\n  size: { width: number; height: number }\r\n) {\r\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n  objectPos.project(camera);\r\n  const widthHalf = size.width / 2;\r\n  const heightHalf = size.height / 2;\r\n  return [\r\n    objectPos.x * widthHalf + widthHalf,\r\n    -(objectPos.y * heightHalf) + heightHalf,\r\n  ];\r\n}\r\n\r\nfunction isObjectBehindCamera(el: Object3D, camera: Camera) {\r\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n  const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\r\n  const deltaCamObj = objectPos.sub(cameraPos);\r\n  const camDir = camera.getWorldDirection(v3);\r\n  return deltaCamObj.angleTo(camDir) > Math.PI / 2;\r\n}\r\n\r\nfunction objectZIndex(\r\n  el: Object3D,\r\n  camera: Camera,\r\n  zIndexRange: Array<number>\r\n) {\r\n  if (\r\n    camera instanceof PerspectiveCamera ||\r\n    camera instanceof OrthographicCamera\r\n  ) {\r\n    const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\r\n    const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\r\n    const dist = objectPos.distanceTo(cameraPos);\r\n    const A = (zIndexRange[1] - zIndexRange[0]) / (camera.far - camera.near);\r\n    const B = zIndexRange[1] - A * camera.far;\r\n    return Math.round(A * dist + B);\r\n  }\r\n  return undefined;\r\n}\r\n\r\nexport interface HtmlProps\r\n  extends Omit<\r\n    Assign<\r\n      React.HTMLAttributes<HTMLDivElement>,\r\n      ReactThreeFiber.Object3DNode<Group, typeof Group>\r\n    >,\r\n    'ref'\r\n  > {\r\n  eps?: number;\r\n  portal?: React.MutableRefObject<HTMLElement>;\r\n  zIndexRange?: Array<number>;\r\n}\r\n\r\nexport const Html = React.forwardRef(\r\n  (\r\n    {\r\n      children,\r\n      eps = 0.001,\r\n      style,\r\n      className,\r\n      portal,\r\n      zIndexRange = [16777271, 0],\r\n      ...props\r\n    }: HtmlProps,\r\n    ref: React.Ref<HTMLDivElement>\r\n  ) => {\r\n    const gl = useThree(({ gl }) => gl);\r\n    const camera = useThree(({ camera }) => camera);\r\n    const scene = useThree(({ scene }) => scene);\r\n    const size = useThree(({ size }) => size);\r\n    const [el] = React.useState(() => document.createElement('div'));\r\n    const group = React.useRef<Group>(null);\r\n    const oldZoom = React.useRef(0);\r\n    const oldPosition = React.useRef([0, 0]);\r\n    const target = portal?.current ?? gl.domElement.parentNode;\r\n\r\n    React.useEffect(() => {\r\n      if (group.current) {\r\n        scene.updateMatrixWorld();\r\n        const vec = calculatePosition(group.current, camera, size);\r\n        el.style.cssText = `position:absolute;top:0;left:0;transform:translate3d(${vec[0]}px,${vec[1]}px,0);transform-origin:0 0;`;\r\n        if (target) {\r\n          target.appendChild(el);\r\n        }\r\n        return () => {\r\n          if (target) target.removeChild(el);\r\n          ReactDOM.unmountComponentAtNode(el);\r\n        };\r\n      }\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [target]);\r\n\r\n    const styles: React.CSSProperties = React.useMemo(() => {\r\n      return {\r\n        position: 'absolute',\r\n        transform: 'none',\r\n        ...style,\r\n      };\r\n    }, [style, size]);\r\n\r\n    React.useLayoutEffect(() => {\r\n      ReactDOM.render(\r\n        <div\r\n          ref={ref}\r\n          style={styles}\r\n          className={className}\r\n          children={children}\r\n        />,\r\n        el\r\n      );\r\n    });\r\n\r\n    useFrame(() => {\r\n      if (group.current) {\r\n        camera.updateMatrixWorld();\r\n        const vec = calculatePosition(group.current, camera, size);\r\n\r\n        if (\r\n          Math.abs(oldZoom.current - camera.zoom) > eps ||\r\n          Math.abs(oldPosition.current[0] - vec[0]) > eps ||\r\n          Math.abs(oldPosition.current[1] - vec[1]) > eps\r\n        ) {\r\n          el.style.display = !isObjectBehindCamera(group.current, camera)\r\n            ? 'block'\r\n            : 'none';\r\n          el.style.zIndex = `${objectZIndex(\r\n            group.current,\r\n            camera,\r\n            zIndexRange\r\n          )}`;\r\n          el.style.transform = `translate3d(${vec[0]}px,${vec[1]}px,0) scale(1)`;\r\n          oldPosition.current = vec;\r\n          oldZoom.current = camera.zoom;\r\n        }\r\n      }\r\n    });\r\n\r\n    return <group {...props} ref={group} />;\r\n  }\r\n);\r\n","import React, { useEffect, useRef, useState, useContext } from 'react';\r\nimport { useThree } from '@react-three/fiber';\r\nimport useAnnounceStore from './announceStore';\r\nimport { useA11ySectionContext } from './A11ySection';\r\nimport { stylesHiddenButScreenreadable } from './A11yConsts';\r\nimport { Html } from './Html';\r\n\r\ninterface A11yCommonProps {\r\n  role: 'button' | 'togglebutton' | 'link' | 'content' | 'image';\r\n  children: React.ReactNode;\r\n  description: string;\r\n  tabIndex?: number;\r\n  showAltText?: boolean;\r\n  focusCall?: (...args: any[]) => any;\r\n  debug?: boolean;\r\n  a11yElStyle?: Object;\r\n  hidden?: boolean;\r\n}\r\n\r\ntype RoleProps =\r\n  | {\r\n      role: 'content';\r\n      activationMsg?: never;\r\n      deactivationMsg?: never;\r\n      actionCall?: never;\r\n      href?: never;\r\n      disabled?: never;\r\n      startPressed?: never;\r\n      tag?: 'p' | 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6';\r\n    }\r\n  | {\r\n      role: 'button';\r\n      activationMsg?: string;\r\n      deactivationMsg?: never;\r\n      actionCall?: () => any;\r\n      href?: never;\r\n      disabled?: boolean;\r\n      startPressed?: never;\r\n      tag?: never;\r\n    }\r\n  | {\r\n      role: 'togglebutton';\r\n      activationMsg?: string;\r\n      deactivationMsg?: string;\r\n      actionCall?: () => any;\r\n      href?: never;\r\n      disabled?: boolean;\r\n      startPressed?: boolean;\r\n      tag?: never;\r\n    }\r\n  | {\r\n      role: 'link';\r\n      activationMsg?: never;\r\n      deactivationMsg?: never;\r\n      actionCall: () => any;\r\n      href: string;\r\n      disabled?: never;\r\n      startPressed?: never;\r\n      tag?: never;\r\n    }\r\n  | {\r\n      role: 'image';\r\n      activationMsg?: never;\r\n      deactivationMsg?: never;\r\n      actionCall?: never;\r\n      href?: never;\r\n      disabled?: never;\r\n      startPressed?: never;\r\n      tag?: never;\r\n    };\r\n\r\ntype Props = A11yCommonProps & RoleProps;\r\n\r\nconst A11yContext = React.createContext({\r\n  focus: false,\r\n  hover: false,\r\n  pressed: false,\r\n});\r\n\r\nA11yContext.displayName = 'A11yContext';\r\n\r\nconst useA11y = () => {\r\n  return useContext(A11yContext);\r\n};\r\n\r\nexport { useA11y };\r\n\r\nexport const A11y: React.FC<Props> = ({\r\n  children,\r\n  description,\r\n  activationMsg,\r\n  deactivationMsg,\r\n  tabIndex,\r\n  href,\r\n  role,\r\n  showAltText = false,\r\n  actionCall,\r\n  focusCall,\r\n  disabled,\r\n  debug = false,\r\n  a11yElStyle,\r\n  startPressed = false,\r\n  tag = 'p',\r\n  hidden = false,\r\n  ...props\r\n}) => {\r\n  let constHiddenButScreenreadable = Object.assign(\r\n    {},\r\n    stylesHiddenButScreenreadable,\r\n    { opacity: debug ? 1 : 0 },\r\n    a11yElStyle\r\n  );\r\n\r\n  const [a11yState, setA11yState] = useState({\r\n    hovered: false,\r\n    focused: false,\r\n    pressed: startPressed ? startPressed : false,\r\n  });\r\n\r\n  const a11yScreenReader = useAnnounceStore(state => state.a11yScreenReader);\r\n\r\n  const overHtml = useRef(false);\r\n  const overMesh = useRef(false);\r\n\r\n  const domElement = useThree(state => state.gl.domElement);\r\n\r\n  // temporary fix to prevent error -> keep track of our component's mounted state\r\n  const componentIsMounted = useRef(true);\r\n  useEffect(() => {\r\n    return () => {\r\n      domElement.style.cursor = 'default';\r\n      componentIsMounted.current = false;\r\n    };\r\n  }, []); // Using an empty dependency array ensures this on\r\n\r\n  React.Children.only(children);\r\n  // @ts-ignore\r\n  const handleOnPointerOver = e => {\r\n    if (e.eventObject) {\r\n      overMesh.current = true;\r\n    } else {\r\n      overHtml.current = true;\r\n    }\r\n    if (overHtml.current || overMesh.current) {\r\n      if (role !== 'content' && role !== 'image' && !disabled) {\r\n        domElement.style.cursor = 'pointer';\r\n      }\r\n      setA11yState({\r\n        hovered: true,\r\n        focused: a11yState.focused,\r\n        pressed: a11yState.pressed,\r\n      });\r\n    }\r\n  };\r\n  // @ts-ignore\r\n  const handleOnPointerOut = e => {\r\n    if (e.eventObject) {\r\n      overMesh.current = false;\r\n    } else {\r\n      overHtml.current = false;\r\n    }\r\n    if (!overHtml.current && !overMesh.current) {\r\n      if (componentIsMounted.current) {\r\n        domElement.style.cursor = 'default';\r\n        setA11yState({\r\n          hovered: false,\r\n          focused: a11yState.focused,\r\n          pressed: a11yState.pressed,\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  function handleBtnClick() {\r\n    //msg is the same need to be clean for it to trigger again in case of multiple press in a row\r\n    a11yScreenReader('');\r\n    window.setTimeout(() => {\r\n      if (typeof activationMsg === 'string') a11yScreenReader(activationMsg);\r\n    }, 100);\r\n    if (typeof actionCall === 'function') actionCall();\r\n  }\r\n\r\n  function handleToggleBtnClick() {\r\n    if (a11yState.pressed) {\r\n      if (typeof deactivationMsg === 'string')\r\n        a11yScreenReader(deactivationMsg);\r\n    } else {\r\n      if (typeof activationMsg === 'string') a11yScreenReader(activationMsg);\r\n    }\r\n    setA11yState({\r\n      hovered: a11yState.hovered,\r\n      focused: a11yState.focused,\r\n      pressed: !a11yState.pressed,\r\n    });\r\n    if (typeof actionCall === 'function') actionCall();\r\n  }\r\n\r\n  const returnHtmlA11yEl = () => {\r\n    if (role === 'button' || role === 'togglebutton') {\r\n      let disabledBtnAttr = disabled\r\n        ? {\r\n            disabled: true,\r\n          }\r\n        : null;\r\n      if (role === 'togglebutton') {\r\n        return (\r\n          <button\r\n            r3f-a11y=\"true\"\r\n            {...disabledBtnAttr}\r\n            aria-pressed={a11yState.pressed ? 'true' : 'false'}\r\n            tabIndex={tabIndex ? tabIndex : 0}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              disabled ? { cursor: 'default' } : { cursor: 'pointer' },\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              if (disabled) {\r\n                return;\r\n              }\r\n              handleToggleBtnClick();\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          >\r\n            {description}\r\n          </button>\r\n        );\r\n      } else {\r\n        //regular btn\r\n        return (\r\n          <button\r\n            r3f-a11y=\"true\"\r\n            {...disabledBtnAttr}\r\n            tabIndex={tabIndex ? tabIndex : 0}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              disabled ? { cursor: 'default' } : { cursor: 'pointer' },\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              if (disabled) {\r\n                return;\r\n              }\r\n              handleBtnClick();\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          >\r\n            {description}\r\n          </button>\r\n        );\r\n      }\r\n    } else if (role === 'link') {\r\n      return (\r\n        <a\r\n          r3f-a11y=\"true\"\r\n          style={Object.assign(\r\n            constHiddenButScreenreadable,\r\n            hidden\r\n              ? { visibility: 'hidden' as const }\r\n              : { visibility: 'visible' as const }\r\n          )}\r\n          href={href}\r\n          onPointerOver={handleOnPointerOver}\r\n          onPointerOut={handleOnPointerOut}\r\n          onClick={e => {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            if (typeof actionCall === 'function') actionCall();\r\n          }}\r\n          onFocus={() => {\r\n            if (typeof focusCall === 'function') focusCall();\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: true,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n          onBlur={() => {\r\n            setA11yState({\r\n              hovered: a11yState.hovered,\r\n              focused: false,\r\n              pressed: a11yState.pressed,\r\n            });\r\n          }}\r\n        >\r\n          {description}\r\n        </a>\r\n      );\r\n    } else {\r\n      let tabIndexP = tabIndex\r\n        ? {\r\n            tabIndex: tabIndex,\r\n          }\r\n        : null;\r\n      if (role === 'image') {\r\n        return (\r\n          <img\r\n            r3f-a11y=\"true\"\r\n            src=\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'/%3E\"\r\n            alt={description}\r\n            {...tabIndexP}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          />\r\n        );\r\n      } else {\r\n        const Tag = tag;\r\n        return (\r\n          <Tag\r\n            r3f-a11y=\"true\"\r\n            {...tabIndexP}\r\n            style={Object.assign(\r\n              constHiddenButScreenreadable,\r\n              hidden\r\n                ? { visibility: 'hidden' as const }\r\n                : { visibility: 'visible' as const }\r\n            )}\r\n            onPointerOver={handleOnPointerOver}\r\n            onPointerOut={handleOnPointerOut}\r\n            onBlur={() => {\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: false,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n            onFocus={() => {\r\n              if (typeof focusCall === 'function') focusCall();\r\n              setA11yState({\r\n                hovered: a11yState.hovered,\r\n                focused: true,\r\n                pressed: a11yState.pressed,\r\n              });\r\n            }}\r\n          >\r\n            {description}\r\n          </Tag>\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  const HtmlAccessibleElement = React.useMemo(returnHtmlA11yEl, [\r\n    description,\r\n    a11yState,\r\n    hidden,\r\n    tabIndex,\r\n    href,\r\n    disabled,\r\n    startPressed,\r\n    tag,\r\n    actionCall,\r\n    focusCall,\r\n  ]);\r\n\r\n  let AltText = null;\r\n  if (showAltText && a11yState.hovered) {\r\n    AltText = (\r\n      <div\r\n        aria-hidden={true}\r\n        style={{\r\n          width: 'auto',\r\n          maxWidth: '300px',\r\n          display: 'block',\r\n          position: 'absolute',\r\n          top: '0px',\r\n          left: '0px',\r\n          transform: 'translate(-50%,-50%)',\r\n          background: 'white',\r\n          borderRadius: '4px',\r\n          padding: '4px',\r\n        }}\r\n      >\r\n        <p\r\n          aria-hidden={true}\r\n          style={{\r\n            margin: '0px',\r\n          }}\r\n        >\r\n          {description}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const section = useA11ySectionContext();\r\n  let portal = {};\r\n  if (section.current instanceof HTMLElement) {\r\n    portal = { portal: section };\r\n  }\r\n\r\n  return (\r\n    <A11yContext.Provider\r\n      value={{\r\n        hover: a11yState.hovered,\r\n        focus: a11yState.focused,\r\n        pressed: a11yState.pressed,\r\n      }}\r\n    >\r\n      <group\r\n        {...props}\r\n        onClick={e => {\r\n          e.stopPropagation();\r\n          if (disabled) {\r\n            return;\r\n          }\r\n          if (role === 'button') {\r\n            handleBtnClick();\r\n          } else if (role === 'togglebutton') {\r\n            handleToggleBtnClick();\r\n          } else {\r\n            if (typeof actionCall === 'function') actionCall();\r\n          }\r\n        }}\r\n        onPointerOver={handleOnPointerOver}\r\n        onPointerOut={handleOnPointerOut}\r\n      >\r\n        {children}\r\n        <Html\r\n          style={{ width: '0px' }}\r\n          position={\r\n            // @ts-ignore\r\n            children.props.position ? children.props.position : 0\r\n          }\r\n          {...portal}\r\n        >\r\n          {AltText}\r\n          {HtmlAccessibleElement}\r\n        </Html>\r\n      </group>\r\n    </A11yContext.Provider>\r\n  );\r\n};\r\n","import React, { useEffect, useState, useContext } from 'react';\r\ninterface Props {\r\n  children: React.ReactNode;\r\n}\r\n\r\ntype aasetA11yPrefersState = {\r\n  prefersReducedMotion: boolean;\r\n  prefersDarkScheme: boolean;\r\n};\r\n\r\nconst A11yUserPreferencesContext = React.createContext({\r\n  a11yPrefersState: {\r\n    prefersReducedMotion: false,\r\n    prefersDarkScheme: false,\r\n  },\r\n  // tslint:disable:no-unused-variable\r\n  setA11yPrefersState: (_state: aasetA11yPrefersState) => {},\r\n  // tslint:enable:no-unused-variable\r\n});\r\n\r\nA11yUserPreferencesContext.displayName = 'A11yUserPreferencesContext';\r\n\r\nconst useUserPreferences = () => {\r\n  return useContext(A11yUserPreferencesContext);\r\n};\r\n\r\nexport { useUserPreferences, A11yUserPreferencesContext };\r\n\r\nexport const A11yUserPreferences: React.FC<Props> = ({ children }) => {\r\n  const [a11yPrefersState, setA11yPrefersState] = useState({\r\n    prefersReducedMotion: false,\r\n    prefersDarkScheme: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const prefersReducedMotionMediaQuery = window.matchMedia(\r\n      '(prefers-reduced-motion: reduce)'\r\n    );\r\n    const prefersDarkSchemeMediaQuery = window.matchMedia(\r\n      '(prefers-color-scheme: dark)'\r\n    );\r\n\r\n    setA11yPrefersState({\r\n      prefersReducedMotion: prefersReducedMotionMediaQuery.matches,\r\n      prefersDarkScheme: prefersDarkSchemeMediaQuery.matches,\r\n    });\r\n\r\n    const handleReducedMotionPrefChange = (e: MediaQueryListEvent) => {\r\n      setA11yPrefersState({\r\n        prefersReducedMotion: e.matches,\r\n        prefersDarkScheme: prefersDarkSchemeMediaQuery.matches,\r\n      });\r\n    };\r\n    const handleDarkSchemePrefChange = (e: MediaQueryListEvent) => {\r\n      setA11yPrefersState({\r\n        prefersReducedMotion: prefersReducedMotionMediaQuery.matches,\r\n        prefersDarkScheme: e.matches,\r\n      });\r\n    };\r\n\r\n    if (typeof prefersReducedMotionMediaQuery.addEventListener === 'function') {\r\n      prefersReducedMotionMediaQuery.addEventListener(\r\n        'change',\r\n        handleReducedMotionPrefChange\r\n      );\r\n    }\r\n    if (typeof prefersDarkSchemeMediaQuery.addEventListener === 'function') {\r\n      prefersDarkSchemeMediaQuery.addEventListener(\r\n        'change',\r\n        handleDarkSchemePrefChange\r\n      );\r\n    }\r\n    return () => {\r\n      if (\r\n        typeof prefersReducedMotionMediaQuery.removeEventListener === 'function'\r\n      ) {\r\n        prefersReducedMotionMediaQuery.removeEventListener(\r\n          'change',\r\n          handleReducedMotionPrefChange\r\n        );\r\n      }\r\n      if (\r\n        typeof prefersDarkSchemeMediaQuery.removeEventListener === 'function'\r\n      ) {\r\n        prefersDarkSchemeMediaQuery.removeEventListener(\r\n          'change',\r\n          handleDarkSchemePrefChange\r\n        );\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <A11yUserPreferencesContext.Provider\r\n      value={{\r\n        a11yPrefersState: {\r\n          prefersReducedMotion: a11yPrefersState.prefersReducedMotion,\r\n          prefersDarkScheme: a11yPrefersState.prefersDarkScheme,\r\n        },\r\n        setA11yPrefersState: setA11yPrefersState,\r\n      }}\r\n    >\r\n      {children}\r\n    </A11yUserPreferencesContext.Provider>\r\n  );\r\n};\r\n","import React, { useEffect } from 'react';\r\nimport useAnnounceStore from './announceStore';\r\n\r\nconst offScreenStyle = {\r\n  border: 0,\r\n  clip: 'rect(0 0 0 0)',\r\n  height: '1px',\r\n  margin: '-1px',\r\n  overflow: 'hidden',\r\n  whiteSpace: 'nowrap' as const,\r\n  padding: 0,\r\n  width: '1px',\r\n  position: 'absolute' as const,\r\n};\r\n\r\nexport const A11yAnnouncer: React.FC = () => {\r\n  const message = useAnnounceStore(state => state.message);\r\n\r\n  useEffect(() => {\r\n    const mouseClickListener = (e: MouseEvent) => {\r\n      if (\r\n        window.document.activeElement?.getAttribute('r3f-a11y') &&\r\n        e.detail !== 0\r\n      ) {\r\n        if (window.document.activeElement instanceof HTMLElement) {\r\n          window.document.activeElement.blur();\r\n        }\r\n      }\r\n    };\r\n    window.addEventListener('click', mouseClickListener);\r\n    return () => {\r\n      window.removeEventListener('click', mouseClickListener);\r\n    };\r\n  });\r\n\r\n  return (\r\n    <div style={offScreenStyle} aria-atomic=\"true\" aria-live=\"polite\">\r\n      {message}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useLayoutEffect, useEffect, useState, useRef } from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport { useUserPreferences } from './A11yUserPreferences';\r\ninterface Props {}\r\n\r\nexport const A11yDebuger: React.FC<Props> = ({}) => {\r\n  const [el] = useState(() => document.createElement('div'));\r\n  const [boundingStyle, setBoundingStyle] = useState({});\r\n  const [debugState, setDebugState] = useState({\r\n    prefersDarkScheme: false,\r\n    prefersReducedMotion: false,\r\n  });\r\n  const { a11yPrefersState, setA11yPrefersState } = useUserPreferences();\r\n  const domStructureRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    el.style.cssText = 'position:fixed;top:0;left:0;';\r\n    el.setAttribute('aria-hidden', 'true');\r\n    document.body.appendChild(el);\r\n    setDebugState({\r\n      prefersDarkScheme: a11yPrefersState.prefersDarkScheme,\r\n      prefersReducedMotion: a11yPrefersState.prefersReducedMotion,\r\n    });\r\n    const selectActiveEl = () => {\r\n      console.log('focused: ', document.activeElement);\r\n      let r3fa11ydebugidref = document.activeElement?.getAttribute(\r\n        'r3f-a11y-debug-id'\r\n      );\r\n      if (r3fa11ydebugidref) {\r\n        document.querySelectorAll('[r3fa11ydebugidref]').forEach(node => {\r\n          //@ts-ignore\r\n          node.style.color = null;\r\n        });\r\n        let refEl = document.querySelector(\r\n          '[r3fa11ydebugidref=\"' + r3fa11ydebugidref + '\"]'\r\n        );\r\n        if (refEl) {\r\n          //@ts-ignore\r\n          refEl.style.color = 'red';\r\n        }\r\n      }\r\n    };\r\n    console.log('enregistre ev');\r\n    document.addEventListener('focus', selectActiveEl, true);\r\n    let superinterval = window.setInterval(() => {\r\n      let r3fPosId = 0;\r\n      //@ts-ignore\r\n      let elements = [];\r\n      document.querySelectorAll('[r3f-a11y]').forEach(node => {\r\n        node.setAttribute('r3f-a11y-debug-id', '' + r3fPosId);\r\n        // let li = document.createElement('li');\r\n        // li.innerHTML = node.tagName ;\r\n        // //@ts-ignore\r\n        // domStructureRef.current.appendChild(li);\r\n        elements.push(\r\n          //@ts-ignore\r\n          <li key={r3fPosId} r3fa11ydebugidref={r3fPosId}>\r\n            {node.tagName}\r\n            <button\r\n              tabIndex={-1}\r\n              onClick={() => {\r\n                console.log(node);\r\n                let clientRect = node.getBoundingClientRect();\r\n                setBoundingStyle({\r\n                  width: clientRect.width,\r\n                  height: clientRect.height,\r\n                  top: clientRect.top,\r\n                  left: clientRect.left,\r\n                });\r\n              }}\r\n            >\r\n              Show\r\n            </button>\r\n          </li>\r\n        );\r\n        r3fPosId++;\r\n      });\r\n      //@ts-ignore\r\n      ReactDOM.render(<>{elements}</>, domStructureRef.current);\r\n    }, 2000);\r\n    return () => {\r\n      clearInterval(superinterval);\r\n      ReactDOM.unmountComponentAtNode(el);\r\n      console.log('remove ev');\r\n      document.removeEventListener('focus', selectActiveEl, true);\r\n    };\r\n  }, [a11yPrefersState]);\r\n\r\n  // @ts-ignore\r\n  const handleChange = e => {\r\n    // @ts-ignore\r\n    setA11yPrefersState({\r\n      prefersDarkScheme:\r\n        e.target.name === 'prefersDarkScheme'\r\n          ? e.target.checked\r\n          : debugState.prefersDarkScheme,\r\n      prefersReducedMotion:\r\n        e.target.name === 'prefersReducedMotion'\r\n          ? e.target.checked\r\n          : debugState.prefersReducedMotion,\r\n    });\r\n  };\r\n\r\n  useLayoutEffect(() => {\r\n    return void ReactDOM.render(\r\n      <>\r\n        <label>\r\n          Prefer dark mode\r\n          <input\r\n            type=\"checkbox\"\r\n            name=\"prefersDarkScheme\"\r\n            checked={debugState.prefersDarkScheme}\r\n            onChange={handleChange}\r\n          />\r\n        </label>\r\n        <label>\r\n          Prefer reduced motion\r\n          <input\r\n            type=\"checkbox\"\r\n            name=\"prefersReducedMotion\"\r\n            checked={debugState.prefersReducedMotion}\r\n            onChange={handleChange}\r\n          />\r\n        </label>\r\n        <h3>R3F Dom order</h3>\r\n        <ul ref={domStructureRef}></ul>\r\n        <div\r\n          style={Object.assign(\r\n            {\r\n              position: 'absolute' as const,\r\n              border: '1px solid white',\r\n              borderRadius: '50%',\r\n              background:\r\n                'linear-gradient( 45deg, rgb(70, 255, 60, 0.7), rgb(0, 64, 193, 0.7))',\r\n              pointerEvents: 'none' as const,\r\n              transition: 'all 200ms ease',\r\n            },\r\n            boundingStyle\r\n          )}\r\n        ></div>\r\n      </>,\r\n      el\r\n    );\r\n  });\r\n\r\n  return <></>;\r\n};\r\n"],"names":["useAnnounceStore","create","set","message","a11yScreenReader","stylesHiddenButScreenreadable","opacity","borderRadius","width","height","overflow","transform","display","userSelect","WebkitUserSelect","WebkitTouchCallout","margin","A11ySectionContext","React","createContext","createRef","displayName","v1","Vector3","v2","v3","calculatePosition","el","camera","size","objectPos","setFromMatrixPosition","matrixWorld","project","widthHalf","heightHalf","x","y","Html","ref","children","eps","style","className","portal","zIndexRange","props","gl","useThree","scene","document","createElement","group","oldZoom","oldPosition","target","current","domElement","parentNode","updateMatrixWorld","vec","cssText","appendChild","removeChild","ReactDOM","styles","position","useFrame","Math","abs","zoom","cameraPos","deltaCamObj","sub","camDir","getWorldDirection","angleTo","PI","isObjectBehindCamera","zIndex","PerspectiveCamera","OrthographicCamera","dist","distanceTo","A","far","near","round","objectZIndex","A11yContext","focus","hover","pressed","A11yUserPreferencesContext","a11yPrefersState","prefersReducedMotion","prefersDarkScheme","setA11yPrefersState","_state","useUserPreferences","useContext","offScreenStyle","border","clip","whiteSpace","padding","description","activationMsg","deactivationMsg","tabIndex","href","role","showAltText","actionCall","focusCall","disabled","debug","a11yElStyle","startPressed","tag","hidden","constHiddenButScreenreadable","Object","assign","useState","hovered","focused","a11yState","setA11yState","state","overHtml","useRef","overMesh","componentIsMounted","useEffect","cursor","Children","only","handleOnPointerOver","e","eventObject","handleOnPointerOut","handleBtnClick","window","setTimeout","handleToggleBtnClick","HtmlAccessibleElement","useMemo","visibility","onPointerOver","onPointerOut","onClick","stopPropagation","onFocus","onBlur","preventDefault","tabIndexP","src","alt","AltText","maxWidth","top","left","background","section","HTMLElement","Provider","value","mouseClickListener","activeElement","getAttribute","detail","blur","addEventListener","removeEventListener","boundingStyle","setBoundingStyle","debugState","setDebugState","domStructureRef","setAttribute","body","selectActiveEl","console","log","r3fa11ydebugidref","_document$activeEleme","querySelectorAll","forEach","node","color","refEl","querySelector","superinterval","setInterval","r3fPosId","elements","push","key","tagName","clientRect","getBoundingClientRect","clearInterval","handleChange","name","checked","useLayoutEffect","type","onChange","pointerEvents","transition","label","refpDesc","keys","reduce","acc","split","join","toLowerCase","pDesc","innerHTML","prepend","prefersReducedMotionMediaQuery","matchMedia","prefersDarkSchemeMediaQuery","matches","handleReducedMotionPrefChange","handleDarkSchemePrefChange"],"mappings":"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"}